{ game_triggered //<map trigger fired>

	local L_ID $get_by_name('ocean')
	
	if ( PARAM1 equals 'deralia_start' ) 
	{
		setvard LOCK_TO_NIGHT 1
		setvard LOCK_SKY fullmoon
		callexternal players ext_environment_change night
		callexternal players ext_change_sky fullmoon
		setprop L_ID skin 2
		usetrigger relay_envlightnight
	}
	else if ( PARAM1 equals 'ara_start' )
	{
		setvard LOCK_SKY sunset02
		usetrigger relay_envlightsunset
		callexternal players ext_change_sky sunset02
	}
	else if ( PARAM1 equals 'isles_start' )
	{
		setprop L_ID skin 3
	}
	else if ( PARAM1 equals 'tundra_start' )
	{
		setvarg G_WEATHER_LOCK snow
		callexternal players ext_weather_change snow
		setprop L_ID skin 1
		setprop L_ID sequence 1
	}
	
	if ( PARAM1 equals 'cannon_fired' ) 
	{
		setprop L_ID sequence 1 //calm ocean
		callexternal players ext_weather_change clear
	}
}

{ player_joined

	if ( LOCK_TO_NIGHT ) callexternal PARAM1 ext_environment_change night
	if ( LOCK_SKY isnot 'LOCK_SKY' ) callexternal PARAM1 ext_change_sky LOCK_SKY
}